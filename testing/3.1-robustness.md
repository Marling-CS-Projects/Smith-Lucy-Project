# 3.1 Testing for Function and Robustness

## Criteria To Assess

Throughout [1.5 Success Criteria](../analysis/1.5-success-criteria.md), I have outlined several points relating to function and robustness. In this section, I will test these success criteria on my solution.

| Criterion | Description                                                                                  |
| --------- | -------------------------------------------------------------------------------------------- |
| 1         | The device will need to collect weather data from the environment through sensors            |
| 2         | The weather station will need to transmit all data collected to the internet to be stored    |
| 4         | The device must make predictions in weather                                                  |
| 5         | The personal weather station itself will need to be suitable for indoor/outdoor environments |
| 6         | The data collected by the weather station should be displayed on the app                     |

### Criterion 1 - Collection of weather data

This test is vital to ensuring the weather station is functional and collects accurate data from its sensors. The device must collect these readings on a regular basis without causing any errors in the system. If this test fails it could result in issues uploading and using data from the database, and displaying it on the app.

There are two main tests that I will conduct to check the function and robustness of weather data collection:

* **The device should run without crashing or error** - This test will check that the C++ code running on the particle argon device works correctly, without reporting any errors. I will then use this to check the network connection and monitor how regularly it disconnects from the network.
* **Data should be received at least once an hour while the weather station is online** - During this test, I will use the timestamp on the weather data recieved to check how regularly data readings are taken.

### Test Outcome

#### Checking for errors and network errors

To test for the device's ability to run without error, I activated the weather station and allowed it to collect data in a variety of locations and conditions. I then monitored the events published on the particle cloud to check for the frequency of errors on the device. Examples of the data collected can be seen below.

(image showing weather station collecting data)

The device was successfully able to recive weather data in a variety of locations, as demonstrated by the particle console. No sensor readings were unsuccessful, and the readings were taken at regular intervals. No errors were reported.

The next step it to test the strength of the weather station's connection to the network. To do this, I need to check how the device responds when it loses connection to the internet. This testing is vital to ensure the weather system is able to cope with any connection errors that are likely to occur when in use, such as changes in signal strength or dissconnecting from wifi. While letting the data collection program run, I monitored the events console for any network issues. This can be seen below.

(message sent when device temporarily disconnects)

I found that overall, the device was able to maintain its connection to the cloud and continue collecting data the majority of the time. However, when the device did disconnect, the device was able to recover quickly and reconnect without requiring any imput from the user. Further details on user interface testing relating to network connection can be found in the [Criterion 6 Testing](3.1-robustness.md#criterion-6-app-functionality-and-robustness) section.

Additionally, I then monitored the signal strength, which represents the strength of the device's connection to wifi, using the particle vitals console.

<figure><img src="../.gitbook/assets/Screenshot 2023-09-15 at 10.36.24.png" alt=""><figcaption></figcaption></figure>

As can be seen on the graph above, the strength of the internet connection varied between 22% and 70%. On avererage the device had a signal strength of approximately 50%. The device was able to collect weather data and record it on the particle cloud throughout the 30 day period, demonstrating that the device is both robust and functional under stress.

#### Frequency of measurements

In this test, I aim to record how regularly the weather station takes measurements from the environment. To do this, I compared the data history on the user interface and the events on the particle console. Originally, I aimed to take weather readings approximately every hour.

(image showing particle console weather readings)

(image showing history user interface)

### Criterion 2 - Uploading weather data to the database

Successfully uploading data collected by the weather station to mongo database is another essential component of my project's robustness and functionality. Within this second test, I will examine how the server is able to deal with receiving data, and its ability to communicate using MQTT.

I aim to complete to tests to check the weather data is uploaded to the database correctly:

* **Connection to remote MQTT broker** - This first test will be used to check that the server python program that connects the weather station to mongo database is functional. This will include checking that all data recieved by the server is recieved by the MQTT broker, and then the database. I will also check that there are no errors in this section.
* **Data recorded correctly on database** -  In this test, I will check that the weather data is correctly stored on the database, so that it can be easily accessed by my user interface.

### Test Outcome

#### Connection to remote MQTT broker

#### Recording data on a database



### Criterion 4 - Weather Predictions

This section will test my back-end's ability to cope under stress and make predictions for future weather conditions. The program should be able to deal with any issues with the dataset, such as missing data values, and not result in error. Additionally, the program must be robust enough to not cause errors on the user interface.

There are three areas relating to this success criteria that will test my solution's ability to make weather predictions:

* **Weather predictions program run without error** - The first test for criterion 4 will check that the weather predictions algorithm is able to run without causing any errors to the weather station. This will include checking that all validation checks work correctly.
* &#x20;**Accuracy of weather predictions** -  In this test, I will examine how the weather predictions made by my system compare to the actual weather readings recorded by my weather station in an outdoor environment. This will ensure that my predictions are both robust and functional.
* **Absence of weather predictions** - This test will check my app's ability to run in the  absence of predictions being provided in the back-end. This could be caused by the predictions not having been make when the server first starts up or if the back-end is unable to access current weather conditions.

### Test Outcome

#### Python program running without error

This first test will check that the weather prediction software runs correctly and without error. To check this,&#x20;

#### Accuracy of weather predictions

#### Dealing with prediction errors

In order for my solution to be robust, my user interface needs to be able to deal with cases where weather predictions are not provided by the back-end server, or when the predictions haven't fully loaded yet.

<figure><img src="../.gitbook/assets/Screenshot 2023-09-14 at 10.58.16.png" alt="" width="375"><figcaption></figcaption></figure>



### Criterion 5 - Indoor and outdoor environments

This test will examine my weather station's ability to cope with both indoor and outdoor environments. More specifically, the weather station must be able to deal with extreme conditions while maintaining a high degree of accuracy, and run without error.

There are two main tests I aim to conduct to ensure that the weather station is able to cope with a variety of environments:

* **Different locations** - This first test will test the weather station's robustness and functionality in a varietly of locations, including both indoors and outdoors. As well as checking the app works correctly, I will test the quality of the network connection in different areas.
* **Extreme weather conditions** - In this section, I will test the weather station's ability to cope with extreme weather conditions. This will ensure that the weather station is able to measure all readings to a high degree of accuracy throughout the year.&#x20;

### Test Outcome

#### Indoor testing

(Images showing how the weather station is able to react to an indoor environment)

#### Outdoor testing

(describe how 3d printed case protects weather station without compramising its accuracy of readings)

(outdoor environment)

#### Dealing with extreme environments

This test focuses on the ability of the weather station to take accurate readings for conditions, in a variety of environments.

Average environment testing:

(image)

Warm environment testing:

(image)

Cold environment testing:

(image)

### Criterion 6 - App functionality and robustness

The final test for functionality and robustness relates to my app's ability to run without crashing, and how long it takes for weather data to load. This will ensure that the user is successfully able to make use of the user interface.

1. **Ability to cope with weather station errors** - In this test, I will check how my app is able to deal with any errors in the system. This will include notifying the user of the issue when appropriate and suggesting some ways to resolve it.
2. **Missing data** - During this test, I will check my app's ability to cope with missing data (for instance, when there is not enough data to fill a graph, or before the first readings is taken).
3. **Browser traffic and network connection** -&#x20;

### Test Outcome

#### Dealing with connection errors

During the tests in [Criterion 1](3.1-robustness.md#criterion-1-collection-of-weather-data), I examined the ability of the weather station to cope with errors relating to internet connection and network. In this section, I will test the overall system's ability to cope with this error, as well as informing the user of the issue.&#x20;

To conduct this test, I deactivated the weather station so that it would not collect any data and left the rest of the system running to see how it would respond. I found that the user interface continued to display the most recent data, and it did not cause any errors in the system. The user interface also informed the user when data readings were last taken, allowing the user to make a judgment on how accurate these readings are (shown by the red box below).&#x20;

<figure><img src="../.gitbook/assets/spaces_9qznOLYuORqyQqywceGp_uploads_FKJgcRBPIhpBW1KhMGN6_Screenshot 2023-09-15 at 10.png" alt="" width="563"><figcaption></figcaption></figure>

The user interface is also able to deal with network errors on the about page, indicated by the red box below.

<figure><img src="../.gitbook/assets/Screenshot 2023-09-15 at 11.47.56.png" alt="" width="563"><figcaption></figcaption></figure>

As shown above, the user interface informs the user that the weather station is currently offline, and provides information on when data was last recieved and when the device was first activated. The app correctly identified the connection error to the weather station, and displayed this information in a user-friendly form. The app also contains a link to the help page, which provides the user with instructions on how to resolve the issue.

#### Dealing with missing data

When a user first activates their own weather station, it is likely that they won't have collected any data before attempting to use the user interface. In this test, I will exaimne the user interface's ability to function without any weather data, and see if it results in any errors.

As I didn't want do delete the data already stored on my current cluster in mongo database, I created a new empty cluster, called testData, to see how the app copes with missing data. I added the following line in the back-end.

```javascript
var Weather = mongoose.model('testData', myDataSchema)
```

